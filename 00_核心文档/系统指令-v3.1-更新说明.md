# 系统指令 v3.0 → v3.1 更新说明

**更新时间**：2026-01-27  
**更新原因**：采纳专业反馈，增强安全性和可信度

---

## 核心改进（7项）

### 1. 工具名不写死 ✅

**问题**：假设了特定工具名存在  
**改进**：改为灵活描述，开工前先确认可用工具

**Before**：
```
- 读取：`Filesystem:read_file`
- 创建：`Filesystem:write_file`
```

**After**：
```
- 读取文件
- 创建文件
注意：开始工作前先确认当前环境可用的工具
```

---

### 2. Emoji使用说明 ✅

**问题**：指令说不要emoji，但自己用了很多（矛盾）  
**改进**：明确说明指令内emoji仅用于导航

**新增说明**：
> 本指令中的emoji仅用于导航，实际输出不使用emoji（除非用户明确要求）

---

### 3. 外部搜索能力条件化 ✅

**问题**：假设能搜索，可能不存在  
**改进**：明确区分有/无搜索能力的处理方式

**新增检查**：
```
外部信息来源：
- 如有搜索能力：明确标注信息来源
- 如无搜索能力：只基于仓库+用户提供材料
- 不确定的信息标注为"待核实"
```

---

### 4. 产品/方案强制元数据 ✅

**问题**：没有可信度指标，精准度无法保证  
**改进**：所有产品和方案必须带4项元数据

**新增字段**：
```
**元数据**（必填）：
- 信息来源：[银行官网URL / 客户经理口径 / 第三方平台]
- 最后核验：YYYY-MM-DD
- 适用地区：[全国 / 具体城市]
- 可信度：[高 / 中 / 低]
```

**说明**：没有元数据的文档视为不完整。

---

### 5. SSOT单一事实源 ✅

**问题**：关键定义可能散落多处  
**改进**：强制定位SSOT，避免重复和矛盾

**新增流程**：
```
定位SSOT（单一事实源）：
- 找到本次任务相关的权威文档
- 如无SSOT，先在`00_核心文档/`创建
- 所有关键定义只在SSOT写一次，其他引用
```

---

### 6. 安全编辑流程 ✅

**问题**：直接编辑可能影响多个文件  
**改进**：编辑前输出变更计划和影响范围

**新增要求**：
```
编辑前输出变更计划：

将要修改：
- 文件A：修改内容X
- 文件B：新增内容Y

影响范围：[列出可能受影响的文件]
回滚方式：[如何恢复]
```

---

### 7. 隐私红线（最重要）✅

**问题**：缺少隐私保护规则  
**改进**：明确禁止写入敏感信息，案例库必须脱敏

**新增红线**：
```
禁止写入真实客户敏感信息：
- 身份证号（完整或部分）
- 完整手机号（只能用139****1234格式）
- 征信报告原件
- 对公账号
- 真实公司全称（案例库用脱敏名称）

案例库脱敏规则：
- 用哈希ID（如"客户A001"）代替真实姓名
- 用区间值（如"年开票100-150万"）代替精确数字
- 删除所有可识别细节
```

---

## 改进原则

### 采纳的建议

1. ✅ **工具不写死**：适应不同环境
2. ✅ **Emoji说明**：消除矛盾
3. ✅ **搜索条件化**：实事求是
4. ✅ **强制元数据**：提升可信度
5. ✅ **SSOT原则**：避免混乱
6. ✅ **变更计划**：安全编辑
7. ✅ **隐私红线**：保护敏感信息

### 保持的平衡

1. ⚖️ **不过度工程化**：这是实习生项目，不是DevOps
2. ⚖️ **保持简洁**：v3.1仍然比v2.1精简70%
3. ⚖️ **实用优先**：流程简化但核心安全不妥协

### 未采纳的部分

1. ❌ **过于复杂的流程**：实习生会困惑
2. ❌ **过多的检查步骤**：保持4个核心检查即可
3. ❌ **技术化的术语**：保持易懂的表达

---

## 对比总结

| 维度 | v3.0 | v3.1 | 改进 |
|------|------|------|------|
| 工具假设 | 写死工具名 | 先确认工具 | ✅ 更灵活 |
| Emoji使用 | 矛盾 | 明确说明 | ✅ 一致性 |
| 搜索能力 | 假设存在 | 条件判断 | ✅ 实事求是 |
| 产品可信度 | 无 | 4项元数据 | ✅ 可追溯 |
| 编辑安全 | 无 | 变更计划 | ✅ 可回滚 |
| 隐私保护 | 无 | 严格红线 | ✅ 合规 |
| 总长度 | 2600字 | 3200字 | +23% |

**结论**：v3.1在保持简洁的同时，增强了安全性和可信度。

---

## 影响分析

### 对实习生的影响

**积极影响**：
- ✅ 更清晰的隐私保护规则（避免踩雷）
- ✅ 产品和方案有元数据（知道信息来源）
- ✅ 编辑前有计划（知道要改什么）

**学习成本**：
- 需要理解SSOT概念（10分钟）
- 需要学会填写元数据（5分钟）
- 总增加：15分钟学习时间

### 对项目的影响

**质量提升**：
- ✅ 产品信息可追溯（知道从哪来）
- ✅ 案例库合规（不泄露隐私）
- ✅ 编辑更安全（有回滚方案）

**维护成本**：
- 产品/方案需要填元数据（+30秒/文档）
- 编辑前要输出计划（+2分钟/次）
- 总增加：可接受的小幅增加

### 对开发的影响

**无影响**：
- v3.1是给Claude看的系统指令
- 开发人员看的是开发文档（05_开发文档/）
- 互不干扰

---

## 实施建议

### 立即生效（今天）

1. **更新系统指令文件**：
   - 替换v3.0为v3.1

2. **创建SSOT文件**（如需要）：
   ```bash
   # 在00_核心文档/创建关键定义文件
   touch 00_核心文档/核心定义-SSOT.md
   ```

3. **更新产品模板**：
   - 在01_银行政策库/产品总表.md添加元数据说明

### 后续执行（本周）

4. **补充现有产品元数据**：
   - 已有的20个产品文档逐步补充元数据
   - 优先级：P1（不急，有新产品再说）

5. **检查案例库脱敏**：
   - 确认04_案例库/中没有敏感信息
   - 如有，立即脱敏处理

---

## FAQ

### Q1：v3.1比v3.0复杂了吗？

**A1**：略微复杂（+23%长度），但都是必要的安全和质量改进。核心简洁原则未变。

### Q2：实习生会不会看不懂？

**A2**：不会。新增的内容都是具体的操作指引，比如"填写元数据"、"脱敏规则"，很直观。

### Q3：元数据是强制的吗？

**A3**：是的。没有元数据的产品/方案视为不完整。这是质量底线。

### Q4：SSOT是什么意思？

**A4**：Single Source of Truth（单一事实源）。关键定义只在一个地方写，其他地方引用。避免混乱。

### Q5：如果用户给了敏感信息怎么办？

**A5**：只提炼结构化字段，不保存原件。文档中用脱敏样例。

---

## 下一步

### 立即做

1. ✅ 替换系统指令为v3.1
2. ✅ 更新CHANGELOG.md
3. ✅ Git提交

### 本周做

4. ⏳ 补充现有产品元数据（不急）
5. ⏳ 检查案例库脱敏

### 持续做

6. 🔄 新产品/方案必须有元数据
7. 🔄 编辑前输出变更计划
8. 🔄 严格遵守隐私红线

---

**v3.1 - 更安全、更可信、依然简洁** ✅

**文档版本**：v1.0  
**创建时间**：2026-01-27  
**维护人**：项目团队
